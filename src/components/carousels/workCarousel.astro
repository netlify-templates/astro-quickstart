---
import Carousel from '../carousel.astro'
import LargeImage from '../largeImage.astro'

const { carouselIndex } = Astro.props

import img1  from '../../../members/isabelle/portfolio/Birds-are-essential-for-our-environment!.svg'
import img2  from '../../../members/shikha/portfolio/Did-you-know.svg'
import img3  from "../../../members/shikha/portfolio/Women's-History-Month!.svg"
import img4  from '../../../members/juhi/portfolio/Little-Wishes-Hospital-Gown-Feb-2023_4.png'
import img5  from '../../../members/juhi/portfolio/Little-Wishes-Hospital-Gown-Feb-2023_5.png'
import img6  from '../../../members/juhi/portfolio/Little-Wishes-Hospital-Gown-Feb-2023_6.png'
import img7  from '../../../members/juhi/portfolio/Little-Wishes-Hospital-Gown-Feb-2023_7.png'
import img8  from '../../../members/samantha/portfolio/Help-save-the-oceans_1.svg'
import img9  from '../../../members/samantha/portfolio/Help-save-the-oceans_2.svg'
import img10  from '../../../members/samantha/portfolio/Help-save-the-oceans_3.svg'
import img11 from '../../../members/samantha/portfolio/Help-save-the-oceans_4.svg'
import img12 from "../../../members/isabelle/portfolio/DON'T-EAT-FROGS.svg"
import img13 from '../../../members/isabelle/portfolio/Untitled-(800-x-1000-px).svg'
import img14 from '../../../members/shikha/portfolio/Elarra.jpg'
import img15 from '../../../members/shikha/portfolio/Fairy.jpg'
import img16 from '../../../members/shikha/portfolio/c3.jpg'
import img17 from '../../../members/shikha/portfolio/Rapunzel.jpg'

var images = []

var members = [
    {
        username: 'isabelle', 
        imgs: await Astro.glob('../../../members/isabelle/portfolio/*'), 
        fullRes: [], 
    }, 
    {
        username: 'juhi', 
        imgs: await Astro.glob('../../../members/juhi/portfolio/*'), 
        fullRes: [], 
    }, 
    {
        username: 'shikha', 
        imgs: await Astro.glob('../../../members/shikha/portfolio/*'), 
        fullRes: [], 
    }, 
    {
        username: 'samantha', 
        imgs: await Astro.glob('../../../members/samantha/portfolio/*'), 
        fullRes: [], 
    }, 
]

members.forEach((m, i) => {
    m.imgs.forEach(img => {
        if (typeof img === 'object') {
            var img = img.default

            var obj = img
            obj.username = m.username

            var hasFRes = members[i].fullRes.filter(r => r.name === getFNameNoExt(img.src))
            if (hasFRes) {
                obj.fullRes = hasFRes[0].src
            }

            images.push(obj)
        }
        else if (typeof img === 'string') {
            if (getFExt(img.default) === 'pdf') {
                members[i].fullRes.push({
                    name: getFNameNoExt(img.default), 
                    src: img.default
                })
            }
        }
    })
})

function getFName(str) {
    if (str.includes('/')) str = str.split('/').slice(-1)[0]
    return str
}

function getFNameNoExt(str) {
    if (str.includes('/')) str = str.split('/').slice(-1)[0]
    str = str.slice(0, -1*getFExt(str).length)

    return str
}

function getFExt(str, level=1) {
    str = getFName(str)
    if (str.includes('.') && level > 0) {
        switch (level) {
            case 1: 
                str = str.split('.').slice(-1, -1).join('.')
                break
            default: 
                str = str.split('.').slice(-1*level, -1).join('.')
                break
        }
    }
    return str
}

function toProper(user) {
    user = `${user.slice(0, 1).toUpperCase()}${user.slice(1)}`
    return user
}

var dId = 'workCarousel'
---
<Carousel carouselIndex={carouselIndex} dataColumns={images.length} dataId={dId}>
    {
        images.map((img, i) => {
            return <pre>{JSON.stringify(img, null, 4)}</pre>
            // return <LargeImage id={`${dId}-${i}`} img={img} alt={`${getFName(data.file)} by ${toProper(data.username)}`}draggable={false} />
        })
    }
</Carousel>